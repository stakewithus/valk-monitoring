version: "3.3"

services:
  vault:
    image: vault
    env_file: app.env
    volumes:
        - ./vault/config:/vault/config
        - ./vault/policies:/vault/policies
        - ./vault/data:/vault/data
    # environment: 
    #   VAULT_DEV_ROOT_TOKEN_ID: password
    ports:
      - "8200:8200"
  server:
    image: valk-server
    env_file: app.env
    build:
      context: .
      dockerfile: Dockerfile
    # depends_on:
    #   - vault
    # environment:
    #   # VAULT_ADDRESS: vault:8200
    #   # VAULT_TOKEN: password
    #   SERVER_PORT: 3001
    ports:
      - "5001:3001"